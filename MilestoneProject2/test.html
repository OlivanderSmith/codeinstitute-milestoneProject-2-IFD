<!DOCTYPE html>
<html lang="en">
  <head>
    <title>dc.js - Bar Chart Example</title>
    <meta charset="UTF-8" />
  </head>
  <body>
    <div class="container">
      <div id="test"></div>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.2/d3.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.12/crossfilter.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/dc/3.0.12/dc.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-queue/3.0.7/d3-queue.min.js"></script>
      <script type="text/javascript">
        var chart = dc.barChart("#test");

        d3.csv("morley.csv").then(function(experiments) {
          experiments.forEach(function(x) {
            x.Speed = +x.Speed;
          });

          var ndx = crossfilter(experiments),
            runDimension = ndx.dimension(function(d) {
              return +d.Run;
            }),
            speedSumGroup = runDimension.group().reduceSum(function(d) {
              return (d.Speed * d.Run) / 1000;
            });
          chart
            .width(768)
            .height(480)
            .x(d3.scaleLinear().domain([6, 20]))
            .brushOn(false)
            .yAxisLabel("This is the Y Axis!")
            .dimension(runDimension)
            .group(speedSumGroup)
            .on("renderlet", function(chart) {
              chart.selectAll("rect").on("click", function(d) {
                console.log("click!", d);
              });
            });
          chart.render();
        });
      </script>
    </div>
  </body>
</html>
